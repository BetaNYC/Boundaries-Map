!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n=n||self).window=n.window||{})}(this,function(i){"use strict";function n(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function s(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){if(!(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n)))return;var e=[],o=!0,a=!1,r=void 0;try{for(var i,c=n[Symbol.iterator]();!(o=(i=c.next()).done)&&(e.push(i.value),!t||e.length!==t);o=!0);}catch(n){a=!0,r=n}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return e}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(n){return function(n){if(Array.isArray(n)){for(var t=0,e=new Array(n.length);t<n.length;t++)e[t]=n[t];return e}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var t;function e(n,t){var e=1<arguments.length&&void 0!==t?t:null;return e?'<span class = "lighter"><a target="_blank" href=\''.concat(e,"'>").concat(n,"</a> </span>"):'<span class = "lighter">'.concat(n,"</span>")}!function(n,t){void 0===t&&(t={});var e=t.insertAt;if(n&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===e&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=n:a.appendChild(document.createTextNode(n))}}("/* Body, Headers, and Text*/\n* {\n  margin: 0;\n  padding: 0;\n}\n\nhtml {\n  box-sizing: border-box;\n  height: 100%;\n}\n\nbody {\n  background: #f2f6f9;\n  height: 100%;\n  font-family: 'lato';\n  font-weight: normal;\n  overflow: hidden;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n\nh1,\nh2,\nh3 {\n  font-family: 'Playfair Display' !important;\n  font-weight: 1000 !important;\n  font-size: 25px !important;\n  padding-bottom: 5px;\n  margin: 0px 0px !important;\n  text-align: center;\n}\n\nh1 {\n  color: black !important;\n}\n\nh4 {\n  text-align: center;\n}\n\nh5,\nh6 {\n  text-align: justify;\n}\n\nh4,\nh5,\nh6 {\n  font-family: 'lato' !important;\n  font-weight: normal !important;\n  padding-bottom: 5px;\n  margin: 0px 0px !important;\n}\n\nlabel {\n  font-family: 'lato' !important;\n}\n\np {\n  font-family: 'lato' !important;\n}\nspan {\n  font-size: 12px;\n  font-family: 'lato' !important;\n}\n\n/*Text Styles*/\n.bold {\n  font-weight: bold !important;\n}\n\n.lighter {\n  color: #444444;\n}\n\n/*Toolboxes and Infoboxes*/\n.separator {\n  min-height: 1px;\n  background-color: rgba(46, 60, 67, 0.08);\n  margin: 16px 0;\n}\n\n.toolbox_left {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  bottom: 0px;\n  width: 30%;\n  /*min-width:200px;\n\tmax-width: 30%;*/\n  height: 100%;\n  z-index: 2;\n  overflow-y: hidden;\n}\n\n@media all and (min-width: 1000px) {\n  .toolbox_left {\n    width: 350px;\n  }\n}\n\n@media all and (max-width: 1000px) {\n  .toolbox_left {\n    width: 300px;\n  }\n}\n\n@media all and (max-width: 800px) {\n  .toolbox_left {\n    width: 200px;\n  }\n}\n\n#about {\n  margin-top: 20px;\n}\n\n.logo {\n  width: 50px;\n  margin: auto;\n  display: block;\n}\n\n.logo_caption {\n  font-size: 10px;\n  text-align: center;\n  margin-top: 5px;\n}\n\n.box {\n  height: 100%;\n  overflow-y: auto;\n  position: relative;\n  overflow-x: hidden;\n  background-color: #fff;\n}\n\n.toolbox {\n  position: relative;\n  overflow-y: hidden;\n}\n\n#info_box {\n  overflow-y: auto;\n  position: relative;\n  overflow-x: hidden;\n  height: 600px;\n}\n\n#info_box {\n  display: none;\n}\n\n.close_button,\n.reset_map {\n  font-size: 11px;\n  float: right;\n}\n\n#footer {\n  text-align: center !important;\n}\n\n.footer_text {\n  font-size: 11px;\n}\n\n/*Icons and Legends*/\nhr {\n  margin-bottom: 10px;\n  margin-top: 10px;\n}\n\n.colored_line {\n  border: none;\n  border-top: 3px solid #000;\n  color: #fff;\n  background-color: #fff;\n  height: 1px;\n  width: 15%;\n  margin-left: 10px;\n}\n\n.legend_text {\n  font-size: 11px;\n}\n\n.switch {\n  position: relative;\n  display: inline-block;\n  width: 22px;\n  height: 14px;\n  margin-right: 5px;\n}\n\n.switch input {\n  display: none;\n}\n\n.slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #ccc;\n  transition: 0.4s;\n}\n\n.slider:before {\n  position: absolute;\n  content: '';\n  height: 8px;\n  width: 8px;\n  left: 3px;\n  bottom: 3px;\n  background-color: white;\n  transition: 0.4s;\n}\n\ninput:checked + .slider {\n  background-color: #6a6a6a;\n}\n\ninput:focus + .slider {\n  box-shadow: 0 0 1px #6a6a6a;\n}\n\ninput:checked + .slider:before {\n  -webkit-transform: translateX(8px);\n  transform: translateX(8px);\n}\n\n/*Map*/\n#container {\n  display: flex;\n  width: 100%;\n  height: 100%;\n}\n\n#map {\n  flex: 1;\n}\n\n@media all and (min-width: 1000px) {\n  .leaflet-left {\n    left: 335px;\n  }\n}\n\n@media all and (max-width: 1000px) {\n  .leaflet-left {\n    left: 285px;\n  }\n}\n\n@media all and (max-width: 800px) {\n  .leaflet-left {\n    left: 185px;\n  }\n}\n\n.leaflet-control-zoom-out {\n  background-color: #fff !important;\n}\n\n.leaflet-control-zoom-in {\n  background-color: #fff !important;\n}\n\n.leaflet-bar {\n  border: 1px solid rgba(46, 60, 67, 0.08) !important;\n}\n\n/*Search*/\n#no_results {\n  display: none;\n}\n\n.search_label {\n  font-size: 14px !important;\n}\n\ninput[type='submit'] {\n  background-color: #6a6a6a;\n  border: none;\n  color: white;\n  padding: 5px 10px;\n  text-decoration: none;\n  cursor: pointer;\n  font-family: 'lato' !important;\n  margin-top: 5px;\n}\n.search_bar {\n  width: 100%;\n  padding: 5px 15px;\n  box-sizing: border-box;\n}\n\n.select_custom {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n\n.select_custom select {\n  display: inline-block;\n  width: 100%;\n  padding: 10px 15px;\n  cursor: pointer;\n  color: #7b7b7b;\n  border: 0;\n  border-radius: 0;\n  outline: 0;\n  background: #e6e6e6;\n  appearance: none;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n}\n\n.select_custom select::-ms-expand {\n  display: none;\n}\n\n.select_custom select:hover,\n.select_custom select:focus {\n  color: #000;\n  background: #ccc;\n}\n\n.select_custom select:disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n\n.select_arrow {\n  position: absolute;\n  top: 12px;\n  right: 15px;\n  width: 0;\n  height: 0;\n  pointer-events: none;\n  border-width: 8px 5px 0 5px;\n  border-style: solid;\n  border-color: #7b7b7b transparent transparent transparent;\n}\n.select_custom select:hover ~ .select_arrow,\n.select_custom select:focus ~ .select_arrow {\n  border-top-color: #000;\n}\n\n.select_custom select:disabled ~ .select_arrow {\n  border-top-color: #ccc;\n}\n\n.city_icons {\n  width: 50px;\n  float: left;\n  margin-right: 10px;\n}\n/*Clears and Margins*/\n.clearfix {\n  overflow: auto;\n  width: 100%;\n}\n\n#suggestions {\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n}\n\n#suggestions li:hover {\n  background-color: rgb(219, 219, 219);\n}\n\n.leaflet-control-zoom {\n  margin-left: 2em !important;\n}\n");var c=document.getElementById("address"),l=document.getElementById("suggestions"),p="SsgRzH9qQSNu92IOf76_9Q",u=(n(t={cd:{name:"Community Districts",sql:"SELECT * FROM all_bounds WHERE id = 'cd' AND NOT namecol IN ('164','226','227','228','355','356','480','481','482')",textColor:"#000000",lineColor:"#000000",icon:"static/NYCCo_human_group_a_01.jpg",formatContent:function(n){return function(n,t){var e;switch(n){case"1":e="Manhattan - ".concat(t);break;case"2":e="Bronx - ".concat(t);break;case"3":e="Brooklyn - ".concat(t);break;case"4":e="Queens - ".concat(t);break;case"5":e="Staten Island - ".concat(t);break;default:e="".concat(n," - ").concat(t)}return'<span class = "lighter">'.concat(e,"</span>")}(n[0],n.substring(1,3))}},pp:{name:"Police Precincts",sql:"SELECT * FROM all_bounds WHERE id = 'pp'",textColor:"#12eded",lineColor:"#12eded",icon:"static/NYCCo_jobs_police_01.jpg",formatContent:function(n){return function(n){return 11==n||12==n||13==n?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/midtown-south-precinct.page\'>'.concat(n,"</a> </span>"):14==n?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(n,"th-precinct.page'>").concat(n,"</a> </span>"):18==n?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/midtown-north-precinct.page\'>'.concat(n,"</a> </span>"):22==n?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/central-park-precinct.page\'>'.concat(n,"</a> </span>"):n%10==1?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(n,"st-precinct.page'>").concat(n,"</a> </span>"):n%10==2?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(n,"nd-precinct.page'>").concat(n,"</a> </span>"):n%10==3?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(n,"rd-precinct.page'>").concat(n,"</a> </span>"):'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(n,"th-precinct.page'>").concat(n,"</a> </span>")}(n)}},sd:{name:"Sanitation Districts",sql:"SELECT * FROM all_bounds WHERE id = 'sd'",textColor:"#12eda4",lineColor:"#12eda4",icon:"static/NYCCo_sanitation_garbage_01.jpg",formatContent:function(n){return e(n)}},fb:{name:"Fire Battilion",sql:"SELECT * FROM all_bounds WHERE id = 'fb'",textColor:"#12ed12",lineColor:"#12ed12",icon:"static/NYCCo_jobs_firefighter_01.jpg",formatContent:function(n){return e(n)}}},"sd",{name:"School Districts",sql:"SELECT * FROM all_bounds WHERE id = 'sd'",textColor:"#eded12",lineColor:"#eded12",haloFill:"#000",haloRadius:.8,icon:"static/NYCCo_food_apple_01.jpg",formatContent:function(n){return e(n)}}),n(t,"hc",{name:"Health Center Districts",sql:"SELECT * FROM all_bounds WHERE id = 'hc'",textColor:"#edbd12",lineColor:"#edbd12",icon:"static/NYCCo_jobs_doctor_01.jpg",formatContent:function(n){return e(n)}}),n(t,"cc",{name:"City Council Districts",sql:"SELECT * FROM all_bounds WHERE id = 'cc'",textColor:"#ed7d12",lineColor:"#ed7d12",icon:"static/NYCCo_government_cityhall_01.jpg",formatContent:function(n){return e(n,"https://council.nyc.gov/district-".concat(n))}}),n(t,"nycongress",{name:"Congressional Districts",sql:"SELECT * FROM all_bounds WHERE id = 'nycongress'",textColor:"#ed1212",lineColor:"#ed1212",icon:"static/NYCCo_domestic_a_01.jpg",formatContent:function(n){return e(n,"https://www.govtrack.us/congress/members/NY/".concat(n))}}),n(t,"sa",{name:"State Assembly Districts",sql:"SELECT * FROM all_bounds WHERE id = 'sa'",textColor:"#ed1294",lineColor:"#ed1294",icon:"static/NYCCo_governement_law_01.jpg",formatContent:function(n){return e(n)}}),n(t,"ss",{name:"State Senate Districts",sql:"SELECT * FROM all_bounds WHERE id = 'ss'",textColor:"#9912ed",lineColor:"#9912ed",icon:"static/NYCCo_government_justice_01.jpg",formatContent:function(n){return e(n,"https://www.nysenate.gov/district/".concat(n))}}),n(t,"nta",{name:"Neighborhood Tabulation Area",sql:"SELECT * FROM all_bounds WHERE id = 'nta'",textColor:"#1212ed",lineColor:"#1212ed",icon:"static/NYCCo_explore_01.jpg",textSmall:!0,formatContent:function(n){return e(n)}}),n(t,"bid",{name:"Business Improvement District",sql:"SELECT * FROM all_bounds WHERE id = 'bid'",textColor:"#129ded",lineColor:"#129ded",icon:"static/NYCCo_jobs_a_01.jpg",textSmall:!0,haloFill:"#fff",haloRadius:.8,formatContent:function(n){return e(n)}}),t);function m(n,t,e){var o=2<arguments.length&&void 0!==e?e:"Clicked point";i.map.setView([n,t],15),i.marker&&i.marker.remove(),i.marker=L.marker([n,t]).addTo(i.map);var a="https://betanyc.carto.com/api/v2/sql/?q=SELECT * FROM all_bounds WHERE ST_Intersects(ST_SetSRID(ST_MakePoint(".concat(t,", ").concat(n,"), 4326),the_geom) &api_key=").concat(p);fetch(a).then(function(n){return n.json()}).then(function(n){return function(r,n){var t=Object.entries(u).map(function(n){var t=s(n,2),e=t[0],o=t[1],a='<img class="city_icons" src="'.concat(o.icon,'"/><h5 class= "">').concat(o.name,"</h5>");return a+=r.filter(function(n){return n.id===e}).reduce(function(n,t){return n.map(function(n){return n.namecol}).includes(t.namecol)?n:[].concat(d(n),[t])},[]).map(function(n){return o.formatContent(n.namecol,n.namealt)}).join('<span class= "lighter">, </span>'),'<div id="ds_info" class="clearfix">'.concat(a,"</div>")}).join("");document.getElementById("info_box").innerHTML='<div id="info"><h3 class = "bold">'.concat(n,' </h3><div class="separator"></div></div>').concat(t),f()}(n.rows,o)})}function f(){(document.getElementById("info_box").style.display="none")&&(document.getElementById("info_box").style.display="block")}function o(e){var n="https://betanyc.carto.com/api/v2/sql/?q=SELECT namecol FROM all_bounds WHERE id = '".concat(e,"' &api_key=").concat(p);!function(n){var t=Object.keys(u);if(!document.getElementById(n).checked){(a=document.getElementById(n)).checked=!0;var e=new Event("change");a.dispatchEvent(e)}for(var o=0;o<t.length;o++)if(t[o]!=n&&document.getElementById(t[o]).checked){var a;(a=document.getElementById(t[o])).checked=!1;e=new Event("change");a.dispatchEvent(e)}}(e),fetch(n).then(function(n){return n.json()}).then(function(n){var t=n.rows.map(function(n){return n.namecol}).sort(function(n,t){return n.localeCompare(t,"en-US",{numeric:"true"})}).map(function(n){return'<option value="'.concat(n,'">').concat(n,"</option>")}).join("");document.getElementById("selected_district").innerHTML='\n\t\t\t<select id="district">'.concat(t,'</select>\n\t\t\t\t<div class="select_arrow"></div>\n\t\t\t<input type="submit" value="Select" onclick="list_overlaps(\'').concat(e,"')\">\n\t\t")}).catch(function(n){return console.log(n)})}i.init=function(){i.map=L.map("map").setView([40.73,-74],11),i.map.doubleClickZoom.disable(),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_nolabels/{z}/{x}/{y}{r}.png",{maxZoom:18}).addTo(i.map);var l=new carto.Client({apiKey:p,username:"betanyc"});Object.entries(u).forEach(function(n){var t=s(n,2),e=t[0],o=t[1];o.source=new carto.source.SQL(o.sql);var a=o.haloFill?"\n\t\t\t\ttext-halo-fill: ".concat(o.haloFill,";\n\t\t\t\ttext-halo-radius: ").concat(o.haloRadius,";\n\t\t\t"):"",r=o.textSmall?"\n      #layer[zoom <= 14]{\n        text-size: 10;\n      }\n      #layer[zoom <= 12]{\n        text-size: 6;\n      }":"";o.style=new carto.style.CartoCSS("\n\t\t\t#layer {\n\t\t\tpolygon-fill: ".concat(o.textColor,";\n\t\t\tpolygon-opacity: 0;\n\t\t\ttext-name: [namecol];\n\t\t\ttext-face-name: 'Open Sans Regular';\n\t\t\ttext-fill: ").concat(o.textColor,";\n\t\t\ttext-size: 14;\n\t\t\t").concat(a,"\n\t\t\t}\n\t\t\t#layer::outline {\n\t\t\tline-width: 2.5;\n\t\t\tline-color: ").concat(o.lineColor,";\n\t\t\tline-opacity: 1;\n\t\t\t}\n\t\t\t#layer[zoom <= 10]{\n\t\t\t\ttext-size: 10;\n\t\t\t}\n\t\t\t#layer::outline [zoom <= 10]{\n\t\t\t\tmarker-width: 1.5;\n      }\n      ").concat(r,"\n\t\t"));var i="extraColumns"in o?o.extraColumns:[],c=[o.textName].concat(d(i));o.layer=new carto.layer.Layer(o.source,o.style,c),l.addLayer(o.layer),document.getElementById("switches").innerHTML+='\n\t\t\t<li>\n\t\t\t\t<label class="switch">\n\t\t\t\t\t<input id="'.concat(e,'" type="checkbox" name="style" onchange="toggle_layer(\'').concat(e,"')\" ").concat("cd"===e?"checked":"",'>\n\t\t\t\t\t<span class="slider"></span>\n\t\t\t\t</label>\n\t\t\t\t<h5>').concat(o.name,'</h5> <hr class="colored_line" style="border-top-color:').concat(o.lineColor,'">\n\t\t\t</li>\n\t\t'),"cd"!==e&&o.layer.hide()}),l.getLeafletLayer().addTo(i.map),L.popup({closeButton:!1});var r=document.getElementById("admin_district");Object.entries(u).forEach(function(n){var t=s(n,2),e=t[0],o=t[1],a=document.createElement("option");a.textContent=o.name,a.value=e,r.appendChild(a)}),r.addEventListener("change",function(n){return o(n.target.value)}),i.map.on("click",function(n){var t=n.latlng;m(t.lat,t.lng)}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(n){var t=n.coords;m(t.latitude,t.longitude)})},i.layers=u,i.list_overlaps=function(e){i.marker&&i.marker.remove();var n=document.getElementById("district"),o=n.options[n.selectedIndex].value,t="SELECT DISTINCT id, namecol, namealt FROM all_bounds, (SELECT the_geom FROM all_bounds WHERE id = '".concat(e,"' AND namecol = '").concat(o,"') as m WHERE ST_Intersects(all_bounds.the_geom, m.the_geom) AND (st_area(st_intersection(all_bounds.the_geom, m.the_geom))/st_area(all_bounds.the_geom)) > .00025"),a="https://betanyc.carto.com/api/v2/sql/?q=".concat(t,"&api_key=").concat(p);fetch(a).then(function(n){return n.json()}).then(function(n){var r=n.rows,t=Object.entries(u).map(function(n){var t=s(n,2),e=t[0],o=t[1],a='<img class="city_icons" src="'.concat(o.icon,'"/><h5 class= "">').concat(o.name,"</h5>");return a+=r.filter(function(n){return n.id===e}).reduce(function(n,t){return n.map(function(n){return n.namecol}).includes(t.namecol)?n:[].concat(d(n),[t])},[]).filter(function(n){return!n.namecol.includes("park-cemetery-etc")}).map(function(n){return o.formatContent(n.namecol,n.namealt)}).join('<span class= "lighter">, </span>'),'<div id="ds_info" class="clearfix">'.concat(a,"</div>")}).join("");document.getElementById("info_box").innerHTML='<div id="info"><h3 class = "bold">'.concat(u[e].name," - ").concat(o,' </h3><div class="separator"></div></div>').concat(t),f()})},i.reset_map=function(){i.map.setView([40.73,-74],11),i.marker&&i.marker.remove()},i.search_address=function(){var n=c.value,t="https://geosearch.planninglabs.nyc/v1/search?text=".concat(n);fetch(t).then(function(n){return n.json()}).then(function(n){for(var t=n.features;l.firstChild;)l.removeChild(l.firstChild);t.forEach(function(n){var t=n.properties.label.replace(", New York, NY, USA",""),e=s(n.geometry.coordinates,2),o=e[0],a=e[1],r=document.createElement("li"),i=document.createElement("a");i.textContent=t,i.addEventListener("click",function(){for(c.value=t;l.firstChild;)l.removeChild(l.firstChild);m(a,o,t)}),r.appendChild(i),l.appendChild(r)})})},i.set_address=function(){fetch("https://geosearch.planninglabs.nyc/v1/search?text=".concat(c.value)).then(function(n){return n.json()}).then(function(n){var t=n.features;if(0<t.length){var e=t[0].properties.label.replace(", New York, NY, USA",""),o=s(t[0].geometry.coordinates,2),a=o[0],r=o[1];for(document.getElementById("no_results").style.display="none",m(r,a,e);l.firstChild;)l.removeChild(l.firstChild)}else document.getElementById("no_results").style.display="block"}).catch(function(n){console.log(n),document.getElementById("no_results").style.display="block"})},i.show_info_box=f,i.toggle_layer=function(n){document.getElementById(n).checked?u[n].layer.show():u[n].layer.hide()},i.toggle_visibility=function(n){var t=document.getElementById(n);"block"==t.style.display?t.style.display="none":t.style.display="block"},Object.defineProperty(i,"__esModule",{value:!0})});
