!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).window=t.window||{})}(this,function(i){"use strict";function t(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function l(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var e=[],o=!0,a=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(o=(i=c.next()).done)&&(e.push(i.value),!n||e.length!==n);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t){return function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var n;function e(t,n){var e=1<arguments.length&&void 0!==n?n:null;return e?'<span class = "lighter"><a target="_blank" href=\''.concat(e,"'>").concat(t,"</a> </span>"):'<span class = "lighter">'.concat(t,"</span>")}!function(t,n){void 0===n&&(n={});var e=n.insertAt;if(t&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===e&&o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}('/* Body, Headers, and Text*/\n* {\n\tmargin:0;\n\tpadding:0;\n}\n\nhtml {\n\tbox-sizing:border-box;\n\theight:100%;\n}\n\nbody {\n\tbackground:#f2f6f9;\n\theight:100%;\n\tfont-family:"lato";\n\tfont-weight:normal;\n\toverflow: hidden;\n\t-webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\nh1, h2, h3 {\n\tfont-family:"Playfair Display" !important;\n\tfont-weight:1000 !important;\n\tfont-size:25px !important;\n\tpadding-bottom: 5px;\n\tmargin: 0px 0px !important;\n\ttext-align: center;\n}\n\nh1 {\n\tcolor:black !important;\n}\n\nh4 {\n\ttext-align:center;\n}\n\nh5, h6 {\n\ttext-align:justify;\n}\n\nh4, h5, h6 {\n\tfont-family:"lato" !important;\n\tfont-weight:normal !important;\n\tpadding-bottom: 5px;\n\tmargin: 0px 0px !important;\n}\n\nlabel {\n\tfont-family:"lato" !important;\n}\n\np {\n\tfont-family:"lato" !important;\n}\nspan {\n\tfont-size:12px;\n\tfont-family:"lato" !important;\n}\n\n/*Text Styles*/\n.bold {\n\tfont-weight:bold !important;\n}\n\n.lighter {\n\tcolor:#444444;\n}\n\n/*Toolboxes and Infoboxes*/\n.separator {\n\tmin-height: 1px;\n\tbackground-color: rgba(46, 60, 67, 0.08);\n\tmargin: 16px 0;\n}\n\n.toolbox_left {\n\tposition: absolute;\n\ttop: 0px;\n\tleft: 0px;\n\tbottom:0px;\n\twidth: 30%;\n\t/*min-width:200px;\n\tmax-width: 30%;*/\n\theight:100%;\n\tz-index: 2;\n\toverflow-y:hidden;\n}\n\n@media all and (min-width: 1000px) {\n    .toolbox_left {\n\t\twidth:350px\n\t}\n}\n\n@media all and (max-width: 1000px) {\n    .toolbox_left {\n\t\twidth:300px\n\t}\n}\n\n@media all and (max-width: 800px) {\n    .toolbox_left {\n\t\twidth:200px\n\t}\n}\n\n#about {\n\tmargin-top:20px;\n}\n\n.logo {\n\twidth:50px;\n\tmargin:auto;\n\tdisplay:block;\n}\n\n.logo_caption {\n\tfont-size:10px;\n\ttext-align:center;\n\tmargin-top:5px;\n}\n\n.box {\n\theight:100%;\n\toverflow-y:auto;\n\tposition:relative;\n\toverflow-x:hidden;\n\tbackground-color:#fff;\n}\n\n.toolbox {\n\tposition:relative;\n\toverflow-y:hidden;\n\n}\n\n#info_box {\n\toverflow-y:auto;\n\tposition:relative;\n\toverflow-x:hidden;\n\theight:600px;\n}\n\n#info_box {\n\tdisplay:none;\n}\n\n.close_button,.reset_map{\n\tfont-size:11px;\n\tfloat:right;\n}\n\n\n#footer {\n\ttext-align:center !important;\n}\n\n.footer_text {\n\tfont-size:11px;\n}\n\n/*Icons and Legends*/\nhr {\n\tmargin-bottom: 10px;\n\tmargin-top: 10px;\n}\n\n.colored_line {\n\tborder:none;\n\tborder-top:3px solid #000;\n\tcolor:#fff;\n\tbackground-color:#fff;\n\theight:1px;\n\twidth:15%;\n\tmargin-left: 10px;\n}\n\n.legend_text {\n\tfont-size:11px;\n}\n\n.switch {\n  position: relative;\n  display: inline-block;\n  width: 22px;\n  height: 14px;\n  margin-right: 5px;\n}\n\n.switch input {display:none;}\n\n.slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #ccc;\n  transition: .4s;\n}\n\n.slider:before {\n  position: absolute;\n  content: "";\n  height: 8px;\n  width: 8px;\n  left: 3px;\n  bottom: 3px;\n  background-color: white;\n  transition: .4s;\n}\n\ninput:checked + .slider {\n  background-color: #6a6a6a;\n}\n\ninput:focus + .slider {\n  box-shadow: 0 0 1px #6a6a6a;\n}\n\ninput:checked + .slider:before {\n  -webkit-transform: translateX(8px);\n  transform: translateX(8px);\n}\n\n/*Map*/\n#container {\n\tdisplay:flex;\n\twidth:100%;\n\theight:100%;\n}\n\n#map {\n\tflex:1;\n}\n\n@media all and (min-width: 1000px) {\n    .leaflet-left{\n        left: 335px;\n    }\n}\n\n@media all and (max-width: 1000px) {\n    .leaflet-left{\n        left: 285px;\n    }\n}\n\n@media all and (max-width: 800px) {\n    .leaflet-left{\n        left: 185px;\n \t}\n}\n\n.leaflet-control-zoom-out {\n\tbackground-color:#fff !important;\n}\n\n.leaflet-control-zoom-in {\n\tbackground-color:#fff !important;\n}\n\n.leaflet-bar {\n\tborder:1px solid rgba(46, 60, 67, 0.08) !important;\n}\n\n/*Search*/\n#no_results {\n\tdisplay:none;\n}\n\n.search_label {\n\tfont-size:14px !important;\n}\n\ninput[type=submit] {\n  background-color: #6a6a6a;\n  border: none;\n  color: white;\n  padding: 5px 10px;\n  text-decoration: none;\n  cursor: pointer;\n\tfont-family:"lato" !important;\n\tmargin-top:5px;\n}\n.search_bar {\n\twidth:100%;\n  padding: 5px 15px;\n  box-sizing: border-box;\n}\n\n.select_custom {\n\tposition: relative;\n\tdisplay: inline-block;\n\twidth: 100%;\n\tmargin-top:5px;\n\tmargin-bottom: 5px;\n}\n\n.select_custom select {\n\tdisplay: inline-block;\n\twidth: 100%;\n\tpadding: 10px 15px;\n\tcursor: pointer;\n\tcolor: #7b7b7b;\n\tborder: 0;\n\tborder-radius: 0;\n\toutline: 0;\n\tbackground: #e6e6e6;\n\tappearance: none;\n\t-webkit-appearance: none;\n\t-moz-appearance: none;\n}\n\n.select_custom select::-ms-expand {\n\tdisplay: none;\n}\n\n.select_custom select:hover,\n.select_custom select:focus {\n\tcolor: #000;\n\tbackground: #ccc;\n}\n\n.select_custom select:disabled {\n\tpointer-events: none;\n\topacity: .5;\n}\n\n.select_arrow {\n\tposition: absolute;\n\ttop: 12px;\n\tright: 15px;\n\twidth: 0;\n\theight: 0;\n\tpointer-events: none;\n\tborder-width: 8px 5px 0 5px;\n\tborder-style: solid;\n\tborder-color: #7b7b7b transparent transparent transparent;\n}\n.select_custom select:hover ~ .select_arrow,\n.select_custom select:focus ~ .select_arrow {\n\tborder-top-color: #000;\n}\n\n.select_custom select:disabled ~ .select_arrow {\n\tborder-top-color: #ccc;\n}\n\n.city_icons {\n\twidth:50px;\n\tfloat: left;\n\tmargin-right:10px;\n}\n/*Clears and Margins*/\n.clearfix {\n\toverflow: auto;\n\twidth:100%;\n}\n\n#suggestions{\n\tlist-style-type: none;\n\tpadding: 0;\n\tmargin: 0;\n}\n\n#suggestions li:hover {\n\tbackground-color: rgb(219, 219, 219);\n}');var c=document.getElementById("address"),d=document.getElementById("suggestions"),p="SsgRzH9qQSNu92IOf76_9Q",u=(t(n={cd:{name:"Community Districts",sql:"SELECT * FROM all_bounds WHERE id = 'cd' AND NOT namecol IN ('164','226','227','228','355','356','480','481','482')",textColor:"#000000",lineColor:"#000000",icon:"static/NYCCo_human_group_a_01.jpg",formatContent:function(t){return function(t,n){var e;switch(t){case"1":e="Manhattan - ".concat(n);break;case"2":e="Bronx - ".concat(n);break;case"3":e="Brooklyn - ".concat(n);break;case"4":e="Queens - ".concat(n);break;case"5":e="Staten Island - ".concat(n);break;default:e="".concat(t," - ").concat(n)}return'<span class = "lighter">'.concat(e,"</span>")}(t[0],t.substring(1,3))}},pp:{name:"Police Precincts",sql:"SELECT * FROM all_bounds WHERE id = 'pp'",textColor:"#12eded",lineColor:"#12eded",icon:"static/NYCCo_jobs_police_01.jpg",formatContent:function(t){return function(t){return 11==t||12==t||13==t?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/midtown-south-precinct.page\'>'.concat(t,"</a> </span>"):14==t?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(t,"th-precinct.page'>").concat(t,"</a> </span>"):18==t?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/midtown-north-precinct.page\'>'.concat(t,"</a> </span>"):22==t?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/central-park-precinct.page\'>'.concat(t,"</a> </span>"):t%10==1?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(t,"st-precinct.page'>").concat(t,"</a> </span>"):t%10==2?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(t,"nd-precinct.page'>").concat(t,"</a> </span>"):t%10==3?'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(t,"rd-precinct.page'>").concat(t,"</a> </span>"):'<span class = "lighter"><a target="_blank" href=\'https://www1.nyc.gov/site/nypd/bureaus/patrol/precincts/'.concat(t,"th-precinct.page'>").concat(t,"</a> </span>")}(t)}},sd:{name:"Sanitation Districts",sql:"SELECT * FROM all_bounds WHERE id = 'sd'",textColor:"#12eda4",lineColor:"#12eda4",icon:"static/NYCCo_sanitation_garbage_01.jpg",formatContent:function(t){return e(t)}},fb:{name:"Fire Battilion",sql:"SELECT * FROM all_bounds WHERE id = 'fb'",textColor:"#12ed12",lineColor:"#12ed12",icon:"static/NYCCo_jobs_firefighter_01.jpg",formatContent:function(t){return e(t)}}},"sd",{name:"School Districts",sql:"SELECT * FROM all_bounds WHERE id = 'sd'",textColor:"#eded12",lineColor:"#eded12",haloFill:"#000",haloRadius:.8,icon:"static/NYCCo_food_apple_01.jpg",formatContent:function(t){return e(t)}}),t(n,"hc",{name:"Health Center Districts",sql:"SELECT * FROM all_bounds WHERE id = 'hc'",textColor:"#edbd12",lineColor:"#edbd12",icon:"static/NYCCo_jobs_doctor_01.jpg",formatContent:function(t){return e(t)}}),t(n,"cc",{name:"City Council Districts",sql:"SELECT * FROM all_bounds WHERE id = 'cc'",textColor:"#ed7d12",lineColor:"#ed7d12",icon:"static/NYCCo_government_cityhall_01.jpg",formatContent:function(t){return e(t,"https://council.nyc.gov/district-".concat(t))}}),t(n,"nycongress",{name:"Congressional Districts",sql:"SELECT * FROM all_bounds WHERE id = 'nycongress'",textColor:"#ed1212",lineColor:"#ed1212",icon:"static/NYCCo_domestic_a_01.jpg",formatContent:function(t){return e(t,"https://www.govtrack.us/congress/members/NY/".concat(t))}}),t(n,"sa",{name:"State Assembly Districts",sql:"SELECT * FROM all_bounds WHERE id = 'sa'",textColor:"#ed1294",lineColor:"#ed1294",icon:"static/NYCCo_governement_law_01.jpg",formatContent:function(t){return e(t)}}),t(n,"ss",{name:"State Senate Districts",sql:"SELECT * FROM all_bounds WHERE id = 'ss'",textColor:"#9912ed",lineColor:"#9912ed",icon:"static/NYCCo_government_justice_01.jpg",formatContent:function(t){return e(t,"https://www.nysenate.gov/district/".concat(t))}}),t(n,"nta",{name:"Neighborhood Tabulation Area",sql:"SELECT * FROM all_bounds WHERE id = 'nta'",textColor:"#1212ed",lineColor:"#1212ed",icon:"static/NYCCo_explore_01.jpg",formatContent:function(t){return e(t)}}),t(n,"bid",{name:"Business Improvement District",sql:"SELECT * FROM all_bounds WHERE id = 'bid'",textColor:"#129ded",lineColor:"#129ded",icon:"static/NYCCo_jobs_a_01.jpg",formatContent:function(t){return e(t)}}),n);function m(t,n,e){var o=2<arguments.length&&void 0!==e?e:"Clicked point";i.map.setView([t,n],15),i.marker&&i.marker.remove(),i.marker=L.marker([t,n]).addTo(i.map);var a="https://betanyc.carto.com/api/v2/sql/?q=SELECT * FROM all_bounds WHERE ST_Intersects(ST_SetSRID(ST_MakePoint(".concat(n,", ").concat(t,"), 4326),the_geom) &api_key=").concat(p);fetch(a).then(function(t){return t.json()}).then(function(t){return function(r,t){var n=Object.entries(u).map(function(t){var n=l(t,2),e=n[0],o=n[1],a='<img class="city_icons" src="'.concat(o.icon,'"/><h5 class= "">').concat(o.name,"</h5>");return a+=r.filter(function(t){return t.id===e}).reduce(function(t,n){return t.map(function(t){return t.namecol}).includes(n.namecol)?t:[].concat(s(t),[n])},[]).map(function(t){return o.formatContent(t.namecol,t.namealt)}).join('<span class= "lighter">, </span>'),'<div id="ds_info" class="clearfix">'.concat(a,"</div>")}).join("");document.getElementById("info_box").innerHTML='<div id="info"><h3 class = "bold">'.concat(t,' </h3><div class="separator"></div></div>').concat(n),f()}(t.rows,o)})}function f(){(document.getElementById("info_box").style.display="none")&&(document.getElementById("info_box").style.display="block")}function o(e){var t="https://betanyc.carto.com/api/v2/sql/?q=SELECT namecol FROM all_bounds WHERE id = '".concat(e,"' &api_key=").concat(p);!function(t){var n=Object.keys(u);if(!document.getElementById(t).checked){(a=document.getElementById(t)).checked=!0;var e=new Event("change");a.dispatchEvent(e)}for(var o=0;o<n.length;o++)if(n[o]!=t&&document.getElementById(n[o]).checked){var a;(a=document.getElementById(n[o])).checked=!1;e=new Event("change");a.dispatchEvent(e)}}(e),fetch(t).then(function(t){return t.json()}).then(function(t){var n=t.rows.map(function(t){return t.namecol}).sort(function(t,n){return t.localeCompare(n,"en-US",{numeric:"true"})}).map(function(t){return'<option value="'.concat(t,'">').concat(t,"</option>")}).join("");document.getElementById("selected_district").innerHTML='\n\t\t\t<select id="district">'.concat(n,'</select>\n\t\t\t\t<div class="select_arrow"></div>\n\t\t\t<input type="submit" value="Select" onclick="list_overlaps(\'').concat(e,"')\">\n\t\t")}).catch(function(t){return console.log(t)})}i.init=function(){i.map=L.map("map").setView([40.73,-74],11),i.map.scrollWheelZoom.disable(),L.tileLayer("https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_nolabels/{z}/{x}/{y}{r}.png",{maxZoom:18}).addTo(i.map);var c=new carto.Client({apiKey:p,username:"betanyc"});Object.entries(u).forEach(function(t){var n=l(t,2),e=n[0],o=n[1];o.source=new carto.source.SQL(o.sql);var a=o.haloFill?"\n\t\t\t\ttext-halo-fill: ".concat(o.haloFill,";\n\t\t\t\ttext-halo-radius: ").concat(o.haloRadius,";\n\t\t\t"):"";o.style=new carto.style.CartoCSS("\n\t\t\t#layer {\n\t\t\tpolygon-fill: ".concat(o.textColor,";\n\t\t\tpolygon-opacity: 0;\n\t\t\ttext-name: [namecol];\n\t\t\ttext-face-name: 'Open Sans Regular';\n\t\t\ttext-fill: ").concat(o.textColor,";\n\t\t\ttext-size: 14;\n\t\t\t").concat(a,"\n\t\t\t}\n\t\t\t#layer::outline {\n\t\t\tline-width: 2.5;\n\t\t\tline-color: ").concat(o.lineColor,";\n\t\t\tline-opacity: 1;\n\t\t\t}\n\t\t\t#layer[zoom <= 10]{\n\t\t\t\ttext-size: 10;\n\t\t\t}\n\t\t\t#layer::outline [zoom <= 10]{\n\t\t\t\tmarker-width: 1.5;\n\t\t\t}\n\t\t"));var r="extraColumns"in o?o.extraColumns:[],i=[o.textName].concat(s(r));o.layer=new carto.layer.Layer(o.source,o.style,i),c.addLayer(o.layer),document.getElementById("switches").innerHTML+='\n\t\t\t<li>\n\t\t\t\t<label class="switch">\n\t\t\t\t\t<input id="'.concat(e,'" type="checkbox" name="style" onchange="toggle_layer(\'').concat(e,"')\" ").concat("cd"===e?"checked":"",'>\n\t\t\t\t\t<span class="slider"></span>\n\t\t\t\t</label>\n\t\t\t\t<h5>').concat(o.name,'</h5> <hr class="colored_line" style="border-top-color:').concat(o.lineColor,'">\n\t\t\t</li>\n\t\t'),"cd"!==e&&o.layer.hide()}),c.getLeafletLayer().addTo(i.map),L.popup({closeButton:!1});var r=document.getElementById("admin_district");Object.entries(u).forEach(function(t){var n=l(t,2),e=n[0],o=n[1],a=document.createElement("option");a.textContent=o.name,a.value=e,r.appendChild(a)}),r.addEventListener("change",function(t){return o(t.target.value)}),i.map.on("click",function(t){var n=t.latlng;m(n.lat,n.lng)}),navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var n=t.coords;m(n.latitude,n.longitude)})},i.layers=u,i.list_overlaps=function(e){var t=document.getElementById("district"),o=t.options[t.selectedIndex].value,n="SELECT DISTINCT id, namecol, namealt FROM all_bounds, (SELECT the_geom FROM all_bounds WHERE id = '".concat(e,"' AND namecol = '").concat(o,"') as m WHERE ST_Intersects(all_bounds.the_geom, m.the_geom) AND (st_area(st_intersection(all_bounds.the_geom, m.the_geom))/st_area(all_bounds.the_geom)) > .00025"),a="https://betanyc.carto.com/api/v2/sql/?q=".concat(n,"&api_key=").concat(p);fetch(a).then(function(t){return t.json()}).then(function(t){var r=t.rows,n=Object.entries(u).map(function(t){var n=l(t,2),e=n[0],o=n[1],a='<img class="city_icons" src="'.concat(o.icon,'"/><h5 class= "">').concat(o.name,"</h5>");return a+=r.filter(function(t){return t.id===e}).filter(function(t){return!t.namecol.includes("park-cemetery-etc")}).map(function(t){return o.formatContent(t.namecol,t.namealt)}).join('<span class= "lighter">, </span>'),'<div id="ds_info" class="clearfix">'.concat(a,"</div>")}).join("");document.getElementById("info_box").innerHTML='<div id="info"><h3 class = "bold">'.concat(u[e].name," - ").concat(o,' </h3><div class="separator"></div></div>').concat(n),f()})},i.reset_map=function(){i.map.setView([40.73,-74],11),i.marker&&i.marker.remove()},i.search_address=function(){var t=c.value,n="https://geosearch.planninglabs.nyc/v1/search?text=".concat(t);fetch(n).then(function(t){return t.json()}).then(function(t){for(var n=t.features;d.firstChild;)d.removeChild(d.firstChild);n.forEach(function(t){var n=t.properties.label.replace(", New York, NY, USA",""),e=l(t.geometry.coordinates,2),o=e[0],a=e[1],r=document.createElement("li"),i=document.createElement("a");i.textContent=n,i.addEventListener("click",function(){for(c.value=n;d.firstChild;)d.removeChild(d.firstChild);m(a,o,n)}),r.appendChild(i),d.appendChild(r)})})},i.set_address=function(){fetch("https://geosearch.planninglabs.nyc/v1/search?text=".concat(c.value)).then(function(t){return t.json()}).then(function(t){var n=t.features;if(0<n.length){var e=n[0].properties.label.replace(", New York, NY, USA",""),o=l(n[0].geometry.coordinates,2),a=o[0],r=o[1];for(document.getElementById("no_results").style.display="none",m(r,a,e);d.firstChild;)d.removeChild(d.firstChild)}else document.getElementById("no_results").style.display="block"}).catch(function(t){console.log(t),document.getElementById("no_results").style.display="block"})},i.show_info_box=f,i.toggle_layer=function(t){document.getElementById(t).checked?u[t].layer.show():u[t].layer.hide()},i.toggle_visibility=function(t){var n=document.getElementById(t);"block"==n.style.display?n.style.display="none":n.style.display="block"},Object.defineProperty(i,"__esModule",{value:!0})});
